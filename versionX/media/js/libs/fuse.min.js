!function(b){function c(g,l){this.list=g,this.options=l=l||{};var e,k,h,j;for(e=0,j=["sort","includeScore","shouldSort"],k=j.length;k>e;e++){h=j[e],this.options[h]=h in l?l[h]:c.defaultOptions[h]}for(e=0,j=["searchFn","sortFn","keys","getFn"],k=j.length;k>e;e++){h=j[e],this.options[h]=l[h]||c.defaultOptions[h]}}var f=function(g,h){if(h=h||{},this.options=h,this.options.location=h.location||f.defaultOptions.location,this.options.distance="distance" in h?h.distance:f.defaultOptions.distance,this.options.threshold="threshold" in h?h.threshold:f.defaultOptions.threshold,this.options.maxPatternLength=h.maxPatternLength||f.defaultOptions.maxPatternLength,this.pattern=h.caseSensitive?g:g.toLowerCase(),this.patternLen=g.length,this.patternLen>this.options.maxPatternLength){throw new Error("Pattern length is too long")}this.matchmask=1<<this.patternLen-1,this.patternAlphabet=this._calculatePatternAlphabet()};f.defaultOptions={location:0,distance:100,threshold:0.6,maxPatternLength:32},f.prototype._calculatePatternAlphabet=function(){var g={},h=0;for(h=0;h<this.patternLen;h++){g[this.pattern.charAt(h)]=0}for(h=0;h<this.patternLen;h++){g[this.pattern.charAt(h)]|=1<<this.pattern.length-h-1}return g},f.prototype._bitapScore=function(h,j){var k=h/this.patternLen,g=Math.abs(this.options.location-j);return this.options.distance?k+g/this.options.distance:g?1:k},f.prototype.search=function(H){if(H=this.options.caseSensitive?H:H.toLowerCase(),this.pattern===H){return{isMatch:!0,score:0}}var C,v,y,q,I,j,F,z,k,E=H.length,x=this.options.location,B=this.options.threshold,G=H.indexOf(this.pattern,x),D=this.patternLen+E,A=1,w=[];for(-1!=G&&(B=Math.min(this._bitapScore(0,G),B),G=H.lastIndexOf(this.pattern,x+this.patternLen),-1!=G&&(B=Math.min(this._bitapScore(0,G),B))),G=-1,C=0;C<this.patternLen;C++){for(y=0,q=D;q>y;){this._bitapScore(C,x+q)<=B?y=q:D=q,q=Math.floor((D-y)/2+y)}for(D=q,I=Math.max(1,x-q+1),j=Math.min(x+q,E)+this.patternLen,F=Array(j+2),F[j+1]=(1<<C)-1,v=j;v>=I;v--){if(k=this.patternAlphabet[H.charAt(v-1)],F[v]=0===C?(F[v+1]<<1|1)&k:(F[v+1]<<1|1)&k|((z[v+1]|z[v])<<1|1)|z[v+1],F[v]&this.matchmask&&(A=this._bitapScore(C,v-1),B>=A)){if(B=A,G=v-1,w.push(G),!(G>x)){break}I=Math.max(1,2*x-G)}}if(this._bitapScore(C+1,x)>B){break}z=F}return{isMatch:G>=0,score:A}};var a=function(q,l,j){var u,g,o;if(l){o=l.indexOf("."),-1!==o?(u=l.slice(0,o),g=l.slice(o+1)):u=l;var k=q[u];if(k){if(g||"string"!=typeof k&&"number"!=typeof k){if(d.isArray(k)){for(var i=0,m=k.length;m>i;i++){a(k[i],g,j)}}else{g&&a(k,g,j)}}else{j.push(k)}}}else{j.push(q)}return j},d={deepValue:function(g,h){return a(g,h,[])},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)}};c.defaultOptions={id:null,caseSensitive:!1,includeScore:!1,shouldSort:!0,searchFn:f,sortFn:function(g,h){return g.score-h.score},getFn:d.deepValue,keys:[]},c.prototype.search=function(q){var H,A,D,w,x=new this.options.searchFn(q,this.options),L=this.list,E=L.length,z=this.options,J=this.options.keys,C=J.length,G=[],o={},I=[],F=function(h,i,l){if(void 0!==h&&null!==h){if("string"==typeof h){D=x.search(h),D.isMatch&&(w=o[l],w?w.score=Math.min(w.score,D.score):(o[l]={item:i,score:D.score},G.push(o[l])))}else{if(d.isArray(h)){for(var g=0;g<h.length;g++){F(h[g],i,l)}}}}};if("string"==typeof L[0]){for(var B=0;E>B;B++){F(L[B],B,B)}}else{for(var B=0;E>B;B++){for(A=L[B],H=0;C>H;H++){F(z.getFn(A,J[H]),A,B)}}}z.shouldSort&&G.sort(z.sortFn);for(var j=z.includeScore?function(e){return G[e]}:function(e){return G[e].item},k=z.id?function(e){G[e].item=z.getFn(G[e].item,z.id)[0]}:function(){},B=0,K=G.length;K>B;B++){k(B),I.push(j(B))}return I},"object"==typeof exports?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):b.Fuse=c}(this);