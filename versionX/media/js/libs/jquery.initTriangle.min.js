$(function(){$.fn.extend({initTriangle:function(c){var G=$.extend({position:[[81,476],[1121,476],[413,17]],fixed:false,logo:false,menu:false,active:false,drawRect:false,style:{color:"#556677",background:"#000"},callback:false,callbackOption:null},c);var C=G.style;$(this).css({"background-color":C.background});if($(this).find("#triangleCanvas").length===0){$(this).append('<canvas id="triangleCanvas" style="position:absolute; left:0; top:0; z-index:-1;"></canvas>')}var b=document.getElementById("triangleCanvas");var z=b.getContext("2d");var l=b.getContext("2d");var u=b.getContext("2d");var e=b.getContext("2d");var h={width:0,height:0,fixTop:0,fixLeft:0,marginTop:-100};var j={color:"rgba(255,255,255,0.5)",borderColor:"rgba(255,255,255,0.5)",borderWidth:1,radius:10};var A=0;var k=G.position;var y=[];var H=function(){var i=$(document);this.width=function(){return Math.max(i.width(),$(window).innerWidth())};this.height=function(){return Math.max(i.height(),$(window).innerHeight())}};var d=new H();var F=function(){b.width=d.width();b.height=d.height();z.clearRect(0,0,b.width,b.height);v();D()};var o=function(K,M,J,L){var i,I;if(K===J){I=0;i=M}else{if(M===L){I=K;i=0}else{I=(J-K)/(L-M);i=(L-M)/(J-K)}}this.returnX=function(N){return I*(N-M)+K};this.returnY=function(N){return i*(N-K)+M}};var x=function(J,N,I,L){var i=Math.abs(I-J);var M=Math.abs(L-N);var K=Math.sqrt(i*i+M*M);return(Math.asin(M/K)/Math.PI*180)*(L>N?1:-1)};var s=function(J,M,I,K){var L=new o(J,M,I,K);var i=[];if(J===I&&M!==K){i.push([J,0],[J,b.height])}else{if(J!==I&&M===K){i.push([0,M],[b.width,M])}else{if(J===I&&M===K){return false}else{i.push([0,L.returnY(0)]);i.push([b.width,L.returnY(b.width)])}}}l.beginPath();l.moveTo(i[0][0],i[0][1]);l.lineTo(i[1][0],i[1][1]);l.closePath();l.strokeStyle=C.color;l.stroke()};var f=[];var m=function(){y.sort(function(L,K){return L.y<K.y});f=[y[0],y[1]];f.sort(function(L,K){return L.x>K.x});var I=x(f[0].x,f[0].y,f[1].x,f[1].y);if(G.menu){G.menu[0].style.webkitTransform="rotate("+I+"deg)";G.menu[0].style.left=((Math.abs(f[0].x-f[1].x)-G.menu[0].offsetWidth)/2+Math.min(f[0].x,f[1].x))+"px";G.menu[0].style.top=(Math.abs(f[0].y-f[1].y)/2+G.menu[0].offsetHeight+Math.min(f[0].y,f[1].y))+"px"}if(G.logo){G.logo[0].style.webkitTransform="rotate("+I+"deg)";G.logo[0].style.left=((Math.abs(f[0].x-f[1].x)-G.logo[0].offsetWidth)/2+Math.min(f[0].x,f[1].x))+"px";G.logo[0].style.top=(Math.abs(f[0].y-f[1].y)/2-G.logo[0].offsetHeight+Math.min(f[0].y,f[1].y))+"px"}if(G.drawRect){var i=new o(f[0].x,f[0].y,f[1].x,f[1].y);var J=new o(y[2].x,y[2].y,f[1].x,f[1].y);e.beginPath();e.moveTo(f[1].x+1,f[1].y+1);e.lineTo(b.width,i.returnY(b.width)+1);e.lineTo(b.width,b.height);e.lineTo(J.returnX(b.height)+1,b.height);e.closePath();e.fillStyle="#112233";e.fill()}};var v=function(){z.beginPath();for(A=0;A<y.length-1;A++){if(A===0){z.moveTo(y[A].x,y[A].y)}else{z.lineTo(y[A].x,y[A].y)}}z.lineTo(y[A].x,y[A].y);z.fillStyle=C.color;z.closePath();z.fill();m();for(A=-1;A<y.length-1;A++){if(A===-1){s(y[y.length-1].x,y[y.length-1].y,y[0].x,y[0].y)}else{s(y[A].x,y[A].y,y[A+1].x,y[A+1].y)}}};var B=function(I,i,J,L,K){this.x=G.fixed?Math.max(0,I):I;this.x=G.fixed?Math.min(b.width,this.x):this.x;this.y=G.fixed?Math.max(0,i):i;this.y=G.fixed?Math.min(b.height,this.y):this.y;this.radius=J;this.color=L;this.borderColor=K;this.isSelected=false};var a=function(I){y=[];for(A=0;A<I.length;A++){var i=new B(I[A][0],I[A][1],j.radius,j.color,j.borderColor);y.push(i)}};var D=function(){var i=function(L,J,K){u.fillStyle=L;u.strokeStyle=J;u.lineWidth=K;this.draw=function(M){if(M.selected){u.lineWidth=4}u.beginPath();u.arc(M.x,M.y,M.radius,Math.PI*0.1,Math.PI*0.4,false);u.stroke();u.beginPath();u.arc(M.x,M.y,M.radius,Math.PI*0.6,Math.PI*0.9,false);u.stroke();u.beginPath();u.arc(M.x,M.y,M.radius,Math.PI*1.1,Math.PI*1.4,false);u.stroke();u.beginPath();u.arc(M.x,M.y,M.radius,Math.PI*1.6,Math.PI*1.9,false);u.stroke()}};var I=new i(j.color,j.borderColor,j.borderWidth);for(A=0;A<y.length;A++){I.draw(y[A])}};var r=null;var t=function(J){J.preventDefault();var i=J.pageX-this.offsetLeft;var K=J.pageY-this.offsetTop;var I=0;for(A=0;A<y.length;A++){I=Math.sqrt(Math.pow(y[A].x-i,2)+Math.pow(y[A].y-K,2));if(I<=j.radius){y[A].selected=true;r=y[A];F();return}}};var g=function(){if(r===null){return false}r.selected=false;r=null;F()};var E=function(i){i.preventDefault();if(r===null){return false}r.x=i.pageX-this.offsetLeft;r.y=i.pageY-this.offsetTop;F()};var w=function(I){var i=function(){if(y.length>0){k=[];for(A=0;A<y.length;A++){k.push([y[A].x-h.fixLeft,y[A].y-h.fixTop])}}b.width="auto";b.height="auto";b.width=d.width();b.height=d.height();h.width=Math.max(k[0][0],k[1][0],k[2][0])-Math.min(k[0][0],k[1][0],k[2][0]);h.height=Math.max(k[0][1],k[1][1],k[2][1])-Math.min(k[0][1],k[1][1],k[2][1]);h.fixLeft=G.fixed?(b.width-h.width)/2:0;h.fixTop=G.fixed?(b.height-h.height)/2+h.marginTop:0;for(A=0;A<k.length;A++){k[A][0]+=h.fixLeft;k[A][1]+=h.fixTop}a(k);z.clearRect(0,0,1000,1000);v();m();if(G.active){D()}if(G.callback){G.callback.call(this,G.callbackOption)}};if(typeof(window.waitInitTriangle)!=="undefined"){clearTimeout(window.waitInitTriangle)}if(typeof(I)==="undefined"){i()}else{window.waitInitTriangle=setTimeout(i,100)}};window.removeEventListener("resize",w);window.addEventListener("resize",w);var p=$("body");var q=p.width()+"*"+p.height();var n=function(){if((p.width()+"*"+p.height())===q){return false}q=p.width()+"*"+p.height();w()};window.listenBodySize=setInterval(n,500);if(G.active){b.removeEventListener("mousedown",t);b.addEventListener("mousedown",t);b.removeEventListener("mouseup",g);b.addEventListener("mouseup",g);b.removeEventListener("mousemove",E);b.addEventListener("mousemove",E)}w();window.rePoints=function(){var i=[];y.forEach(function(I){i.push([I.x,I.y])});return i}}})});